---
# ConfigMap for non-sensitive configuration
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: default
  labels:
    app: chatbot-rag
data:
  # Application settings
  environment: "production"
  region: "us-central1"
  ADMIN_EMAILS: "raman.gaur@capgemini.com"
  
  # Model configuration
  model_variant: "gemini-2.0-flash-001"
  embedding_model: "text-embedding-004"
  
  # Storage configuration
  gcs_bucket: "btoproject-486405-486604-rag-documents"
  
  # Redis configuration (non-sensitive)
  redis_ttl_days: "30"
  redis_use_auth: "true"
  
  # Feature flags
  use_firestore: "true"
  enable_pii_detection: "true"
  enable_ragas_eval: "true"
  
  # RAG configuration
  chunk_size: "1000"
  chunk_overlap: "200"
  top_k_results: "10"
  
---
# Secret placeholders - These should be created manually or via Terraform
# kubectl create secret generic app-secrets \
#   --from-literal=redis_host=<REDIS_IP> \
#   --from-literal=redis_port=6379 \
#   --from-literal=redis_password=<REDIS_AUTH_STRING> \
#   --from-literal=admin_emails=admin@example.com,admin2@example.com \
#   --from-literal=google_client_ids=<CLIENT_ID>.apps.googleusercontent.com

apiVersion: v1
kind: Secret
metadata:
  name: app-secrets
  namespace: default
  labels:
    app: chatbot-rag
type: Opaque
stringData:
  # Redis connection (get from: gcloud redis instances describe chatbot-chat-history --region=us-central1)
  redis_host: "<REDIS_HOST_IP>"
  redis_port: "6379"
  redis_password: ""  # Basic tier Redis has no AUTH, leave empty
  
  # Authentication (from Secret Manager)
  admin_emails: "raman.gaur@capgemini.com"
  google_client_ids: "382685100652-iv2oi4284kv8hjo161ti239dslbf85t3.apps.googleusercontent.com"
  
---
# Instructions for updating secrets
# Get actual values from GCP:
#
# 1. Get Redis host:
#    export REDIS_HOST=$(gcloud redis instances describe chatbot-chat-history --region=us-central1 --format='value(host)')
#
# 2. Get OAuth Client ID:
#    export OAUTH_CLIENT_ID=$(gcloud secrets versions access latest --secret=google-oauth-client-id)
#
# 3. Create secret:
#    kubectl create secret generic app-secrets \
#      --from-literal=redis_host=$REDIS_HOST \
#      --from-literal=redis_port=6379 \
#      --from-literal=redis_password="" \
#      --from-literal=admin_emails=your-email@example.com \
#      --from-literal=google_client_ids=$OAUTH_CLIENT_ID \
#      --dry-run=client -o yaml | kubectl apply -f -
